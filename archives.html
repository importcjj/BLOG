<!DOCTYPE html>
<html lang="en">
<head>
        <title>Signal</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta charset="utf-8" />
        <!-- twitter card metadata -->
        <!-- OG Tags -->
        <!-- favicon -->
        <!-- moment.js for date formatting -->
        <script src="https://importcjj.github.io/theme/js/moment.js"></script>
        <!-- css -->
        <link rel="stylesheet" type="text/css" href="https://importcjj.github.io/theme/css/main.css" />
		<script>
			
                /*! grunt-grunticon Stylesheet Loader - v2.1.2 | https://github.com/filamentgroup/grunticon | (c) 2015 Scott Jehl, Filament Group, Inc. | MIT license. */
    
    (function(e){function t(t,n,r,o){"use strict";function a(){for(var e,n=0;u.length>n;n++)u[n].href&&u[n].href.indexOf(t)>-1&&(e=!0);e?i.media=r||"all":setTimeout(a)}var i=e.document.createElement("link"),l=n||e.document.getElementsByTagName("script")[0],u=e.document.styleSheets;return i.rel="stylesheet",i.href=t,i.media="only x",i.onload=o||null,l.parentNode.insertBefore(i,l),a(),i}var n=function(r,o){"use strict";if(r&&3===r.length){var a=e.navigator,i=e.Image,l=!(!document.createElementNS||!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect||!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")||e.opera&&-1===a.userAgent.indexOf("Chrome")||-1!==a.userAgent.indexOf("Series40")),u=new i;u.onerror=function(){n.method="png",n.href=r[2],t(r[2])},u.onload=function(){var e=1===u.width&&1===u.height,a=r[e&&l?0:e?1:2];n.method=e&&l?"svg":e?"datapng":"png",n.href=a,t(a,null,null,o)},u.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",document.documentElement.className+=" grunticon"}};n.loadCSS=t,e.grunticon=n})(this);(function(e,t){"use strict";var n=t.document,r="grunticon:",o=function(e){if(n.attachEvent?"complete"===n.readyState:"loading"!==n.readyState)e();else{var t=!1;n.addEventListener("readystatechange",function(){t||(t=!0,e())},!1)}},a=function(e){return t.document.querySelector('link[href$="'+e+'"]')},c=function(e){var t,n,o,a,c,i,u={};if(t=e.sheet,!t)return u;n=t.cssRules?t.cssRules:t.rules;for(var l=0;n.length>l;l++)o=n[l].cssText,a=r+n[l].selectorText,c=o.split(");")[0].match(/US\-ASCII\,([^"']+)/),c&&c[1]&&(i=decodeURIComponent(c[1]),u[a]=i);return u},i=function(e){var t,o,a;o="data-grunticon-embed";for(var c in e)if(a=c.slice(r.length),t=n.querySelectorAll(a+"["+o+"]"),t.length)for(var i=0;t.length>i;i++)t[i].innerHTML=e[c],t[i].style.backgroundImage="none",t[i].removeAttribute(o);return t},u=function(t){"svg"===e.method&&o(function(){i(c(a(e.href))),"function"==typeof t&&t()})};e.embedIcons=i,e.getCSS=a,e.getIcons=c,e.ready=o,e.svgLoadedCallback=u,e.embedSVG=u})(grunticon,this);
                
                grunticon(["https://importcjj.github.io/theme/css/icons.data.svg.css", "https://importcjj.github.io/theme/css/icons.data.png.css", "https://importcjj.github.io/theme/css/icons.fallback.css"]);
            </script>
        <noscript><link href="https://importcjj.github.io/theme/css/icons.fallback.css" rel="stylesheet"></noscript>
        <!-- menu toggle javascript -->
        <script type="text/javascript">
            document.addEventListener("DOMContentLoaded", initMenu);
            
            function initMenu(){
                var menu = document.getElementById("menu");
                var menulink = document.getElementById("menu-link");
                menulink.addEventListener("click", function toggleMenu(){
                        window.event.preventDefault();
                        menulink.classList.toggle('active');
                        menu.classList.toggle('active');              
                    });
            };
        </script>
</head>
<body>
<a href="https://github.com/importcjj">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
    <div role="banner" id="masthead">
        <header>
            <h1><a href="/">'s Blog</a></h1>
            <a href="#menu" id="menu-link">more stuff</a>
            <nav id="menu">
                <ul>
                            <li><a href="https://importcjj.github.io/category/centos.html">CentOS</a></li>
                            <li><a href="https://importcjj.github.io/category/docker.html">Docker</a></li>
                            <li><a href="https://importcjj.github.io/category/emacs.html">Emacs</a></li>
                            <li><a href="https://importcjj.github.io/category/git.html">git</a></li>
                            <li><a href="https://importcjj.github.io/category/github.html">github</a></li>
                            <li><a href="https://importcjj.github.io/category/go.html">Go</a></li>
                            <li><a href="https://importcjj.github.io/category/markdown.html">Markdown</a></li>
                            <li><a href="https://importcjj.github.io/category/python.html">Python</a></li>
                            <li><a href="https://importcjj.github.io/category/rust.html">Rust</a></li>
                            <li><a href="https://importcjj.github.io/category/sundry.html">sundry</a></li>
                            <li><a href="https://importcjj.github.io/category/tool.html">Tool</a></li>
                </ul>
            </nav>
        </header>
    </div>
        <div class="page" role="main">
<div class="page-title">
        <h1>archives</h1>
    </div>
<div class="articles">
    <ol>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2019-09-05 15:21:22+08:00">
                            <script>document.write(moment('2019-09-05 15:21:22+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/rust.html"><span class="category-tag">Rust</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/rustde-macroxiao-ji-yi.html">
                        <h2>Rust的macro小记(一)</h2>
                    </a>
                </header>
                <div class="summary"><p>这篇记录一下Rust中的Function-like macros，也就是形如println!(...)形式的宏。</p>
<p>先来一个简单的</p>
<div class="highlight"><pre><span></span><span class="n">macro_rules</span><span class="o">!</span><span class="w"> </span><span class="n">hello</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">println</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;Hello, World!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">hello</span><span class="o">!</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>上面这个简单的例子中， 定义了一个叫做hello的宏，匹配规则为空。作用就是在使用该宏的地方，插入代码<code>println!("Hello, World!");</code>。
接下来我们加入匹配规则，来让这个宏更加的灵活.</p>
<div class="highlight"><pre><span></span><span class="n">macro_rules</span><span class="o">!</span><span class="w"> </span><span class="n">hello</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">println</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;Hello, World!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="cp">$name</span>:<span class="nc">expr</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">println</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;Hello, {}!&quot;</span><span class="p">,</span><span class="w"> </span><span class="cp">$name</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">hello</span><span class="o">!</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">hello</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;rust&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>现在增加了一个匹配规则，这样编译器在在工作时会按规则匹配，使用不同的代码分支。那可不可以让<code>hello</code>支持多个参数呢?
当然可以！宏的匹配规则支持重复模式!</p>
<ul>
<li><code>*</code> 模式重复零次或多次</li>
<li><code>+</code> 模式重复一次或多次</li>
<li><code>?</code> 模式出现零次或一次</li>
</ul>
<p>让我们来稍加改造一下 ...</p> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/rust.html" class="tag">rust</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/rustde-macroxiao-ji-yi.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2019-09-04 16:02:14+08:00">
                            <script>document.write(moment('2019-09-04 16:02:14+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/rust.html"><span class="category-tag">Rust</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/rustshi-yong-matchde-xiao-fa-xian.html">
                        <h2>Rust使用match的小发现</h2>
                    </a>
                </header>
                <div class="summary"><p>今天在读一个库的代码时候，发现了之前使用match的时候没有注意的一个地方。</p>
<div class="highlight"><pre><span></span><span class="k">enum</span> <span class="nc">Foo</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">One</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">Two</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">Three</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">main</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Foo</span>::<span class="n">One</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Foo</span>::<span class="n">One</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">println</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;It&#39;s one&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="n">others</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">println</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;It&#39;s others&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>这里没有使用<code>_</code>去匹配其他分支，而是随意指定了一个名字<code>others</code>。貌似对可读性有一定提升。</p> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/rust.html" class="tag">rust</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/rustshi-yong-matchde-xiao-fa-xian.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2017-01-16 11:22:11+08:00">
                            <script>document.write(moment('2017-01-16 11:22:11+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/go.html"><span class="category-tag">Go</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/golangjie-kou-xing-han-shu.html">
                        <h2>Golang接口型函数</h2>
                    </a>
                </header>
                <div class="summary"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
<span class="p">)</span>

<span class="kd">type</span> <span class="nx">Handler</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nx">Do</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="nx">v</span> <span class="kd">interface</span><span class="p">{})</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">HandlerFunc</span> <span class="kd">func</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="nx">v</span> <span class="kd">interface</span><span class="p">{})</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="nx">HandlerFunc</span><span class="p">)</span> <span class="nx">Do</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="nx">v</span> <span class="kd">interface</span><span class="p">{})</span> <span class="p">{</span>
    <span class="nx">f</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">Each</span><span class="p">(</span><span class="nx">m</span> <span class="kd">map</span><span class="p">[</span><span class="kd">interface</span><span class="p">{}]</span><span class="kd">interface</span><span class="p">{},</span> <span class="nx">h</span> <span class="nx">Handler</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">m</span> <span class="p">{</span>
        <span class="nx">h</span><span class="p">.</span><span class="nx">Do</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">EachFunc</span><span class="p">(</span><span class="nx">m</span> <span class="kd">map</span><span class="p">[</span><span class="kd">interface</span><span class="p">{}]</span><span class="kd">interface ...</span></pre></div> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/go.html" class="tag">Go</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/golangjie-kou-xing-han-shu.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-06-20 17:44:21+08:00">
                            <script>document.write(moment('2016-06-20 17:44:21+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/go.html"><span class="category-tag">Go</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/gowang-luo-bian-cheng-ji-lei-yi.html">
                        <h2>go网络编程积累(一)</h2>
                    </a>
                </header>
                <div class="summary"><div class="highlight"><pre><span></span><span class="c1">//server.go</span>
<span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;net&quot;</span>
    <span class="s">&quot;os&quot;</span>
    <span class="s">&quot;io&quot;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">ln</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">net</span><span class="p">.</span><span class="nx">Listen</span><span class="p">(</span><span class="s">&quot;tcp&quot;</span><span class="p">,</span> <span class="s">&quot;:8888&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Can&#39;t listen&quot;</span><span class="p">)</span>
        <span class="nx">os</span><span class="p">.</span><span class="nx">Exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">{</span>
        <span class="nx">conn</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ln</span><span class="p">.</span><span class="nx">Accept</span><span class="p">()</span>
        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Can&#39;t accept a conn&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="p">}</span>
        <span class="k">go</span> <span class="nx">handleConn</span><span class="p">(</span><span class="nx">conn</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">handleConn</span><span class="p">(</span><span class="nx">conn ...</span></pre></div> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/web.html" class="tag">web</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/gowang-luo-bian-cheng-ji-lei-yi.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-05-18 14:07:45+08:00">
                            <script>document.write(moment('2016-05-18 14:07:45+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/python.html"><span class="category-tag">Python</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/greenlet-qing-liang-ji-bing-fa-bian-cheng.html">
                        <h2>Greenlet: 轻量级并发编程</h2>
                    </a>
                </header>
                <div class="summary"><h4>动机</h4>
<p>greenlet这个包拆分自Stackless。Stackless是一个CPython的版本，实现并支持一种叫做tasklets的微线程。Tasklets会以一种伪并发的方式运行(通常运行在单个或者一些系统级的线程中)，它们之间通过channels来同步数据。</p>
<p>一个greenlet，从另一方面来说，依然是一种很原始的没有隐式调度的微线程。换句话说，就是协程(coroutine)。这在你想要完全控制代码的运行时是非常有用的。你可以在greenlet之上构建采用自定义调度方式的微线程。然而，使用greenlet来制作先进的控制流结构是很有用的。举个例子，我们可以重新创造生成器。和Python自带的生成器所不同的是，我们的生成器可以调用网状的方法，而且这些网状的方法也可以yield出值。(另外，你不需要再使用<strong>yield</strong>这个关键词了）</p>
<h4>举例</h4>
<p>我们来思考一个程序，用户可以在一个类终端控制台中输入命令来控制该程序。假设命令是一个字符一个字符的输入。在这样一个系统中，通常会存在如下一个循环:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">process_commands</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">+=</span> <span class="n">read_next_char</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;quit</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="k">print ...</span></pre></div> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/concurrent.html" class="tag">concurrent</a></li>
                        <li><a href="https://importcjj.github.io/tag/gevent.html" class="tag">gevent</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/greenlet-qing-liang-ji-bing-fa-bian-cheng.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-05-10 02:04:13+08:00">
                            <script>document.write(moment('2016-05-10 02:04:13+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/go.html"><span class="category-tag">Go</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/golangbian-cheng-lian-xi.html">
                        <h2>Golang编程练习</h2>
                    </a>
                </header>
                <div class="summary"><p>完整代码 <a href="https://github.com/importcjj/fooutils">戳这里</a></p>
<h5>1. 验证给定字符串是否为合法身份证号码</h5>
<p>算法：前17位纯数字分别乘以相应的因子，然后求和后除以11取余数。使用该余数取得校验字节数组中相位位置的字节与身份证最后一位字节做比较。如果相等即为合法身份证！</p>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;fmt&quot;</span>
<span class="kn">import</span> <span class="s">&quot;strconv&quot;</span>

<span class="kd">var</span> <span class="p">(</span>
    <span class="nx">Factories</span>    <span class="p">[</span><span class="mi">17</span><span class="p">]</span><span class="kt">int</span> <span class="p">=</span> <span class="p">[</span><span class="mi">17</span><span class="p">]</span><span class="kt">int</span><span class="p">{</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">}</span>
    <span class="nx">ValidateBits</span> <span class="p">[]</span><span class="kt">byte</span>  <span class="p">=</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;10X98765432&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">IsValidIDCode</span><span class="p">(</span><span class="nx">id</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
    <span class="nx">idBytes</span> <span class="o">:=</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">id ...</span></pre></div> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/go.html" class="tag">Go</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/golangbian-cheng-lian-xi.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-04-30 23:38:20+08:00">
                            <script>document.write(moment('2016-04-30 23:38:20+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/sundry.html"><span class="category-tag">sundry</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/jian-dan-de-acfunzi-dong-qian-dao.html">
                        <h2>简单的Acfun自动签到</h2>
                    </a>
                </header>
                <div class="summary"><p><img alt="acfun" src="http://7xsw69.com1.z0.glb.clouddn.com/acfun.jpg" /></p>
<h3>1.概述</h3>
<p>Acfun有一个签到机制，每天签到可以领取经验和香蕉。之前在玩supervisor，celerybeat和rabbitmq的时候搞了一个自动签到的定时任务，但是由于服务器的原因，每天都会出问题。而且前段时间，那台服务器也到期了，所以现在有必要再搞一个简单的自动签到任务了。：）</p>
<h3>2. 签到</h3>
<p>为了简便，这里就不使用Python了。直接curl搞定吧！上代码：</p>
<div class="highlight"><pre><span></span>curl --cookie-jar cookies -d <span class="s2">&quot;username=name&amp;password=passwd&quot;</span> http://www.acfun.tv/login.aspx <span class="o">&amp;&amp;</span> <span class="nb">echo</span>
curl --cookie cookies -d <span class="s2">&quot;channel=0&amp;date=`date +%s`000&quot;</span> http://www.acfun.tv/webapi/record/actions/signin ...</pre></div> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/shell.html" class="tag">shell</a></li>
                        <li><a href="https://importcjj.github.io/tag/contab.html" class="tag">contab</a></li>
                        <li><a href="https://importcjj.github.io/tag/curl.html" class="tag">curl</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/jian-dan-de-acfunzi-dong-qian-dao.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-04-26 16:10:27+08:00">
                            <script>document.write(moment('2016-04-26 16:10:27+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/python.html"><span class="category-tag">Python</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/pythondan-li-mo-shi-de-shi-xian.html">
                        <h2>Python单例模式的实现</h2>
                    </a>
                </header>
                <div class="summary"><h4>由于实现的方式很多，先来3种。</h4>
<h4>1. 类实例实现的单例装饰器</h4>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">functools</span>

<span class="k">class</span> <span class="nc">Singleton</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instances</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
        <span class="nd">@functools.wraps</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">wrapper</span>

<span class="n">singleton</span> <span class="o">=</span> <span class="n">Singleton</span><span class="p">()</span>

<span class="c1"># 用法</span>
<span class="nd">@singleton</span>
<span class="k">class</span> <span class="nc">Test</span><span class="p">(</span><span class="nb">object ...</span></pre></div> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/singleton.html" class="tag">singleton</a></li>
                        <li><a href="https://importcjj.github.io/tag/zhuang-shi-qi.html" class="tag">装饰器</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/pythondan-li-mo-shi-de-shi-xian.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-04-21 19:28:46+08:00">
                            <script>document.write(moment('2016-04-21 19:28:46+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/sundry.html"><span class="category-tag">sundry</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/hhkb-type-skai-xiang-ti-yan.html">
                        <h2>HHKB Type-S开箱体验</h2>
                    </a>
                </header>
                <div class="summary"><p>先上一张图</p>
<p><img alt="my HHKB Type-S" src="http://7xsw69.com1.z0.glb.clouddn.com/%257EN%2524IE%2525BPA59T9P627%255BFAL%255BW.jpg" /></p>
<p>在上一张图，是今天用这块HHKB Type-s来完成的一个简易私人图床，我起名为Tubed，使用了七牛提供的存储服务。配合Unclutter可以轻松完成图片的上传和浏览。
下图为将qq中的图片上传到我的图床。</p>
<p><img alt="tubed usage" src="http://7xsw69.com1.z0.glb.clouddn.com/tubed.gif" /></p>
<p>至于HHKB Type-s的使用感受，下次有空在写吧！（主要是刚才写了一大段，被我不小心关掉了:&lt;</p> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/hhkb.html" class="tag">hhkb</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/hhkb-type-skai-xiang-ti-yan.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-04-11 17:39:08+08:00">
                            <script>document.write(moment('2016-04-11 17:39:08+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/tool.html"><span class="category-tag">Tool</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/hao-yong-de-gong-ju-he-ruan-jian-ji-lu.html">
                        <h2>好用的工具和软件记录</h2>
                    </a>
                </header>
                <div class="summary"><h4>Mac OS X</h4>
<ol>
<li>licecap: 免费好用的gif录屏软件。</li>
</ol>
<h4>Windows</h4>
<p>1.<a href="https://sourceforge.net/projects/unxutils/">unxutils</a>一套能让你在Windows体验bash的工具集。</p>
<p>解压后只要将<code>usr/local/wbin</code>文件的绝对路径添加进环境变量<strong>Path</strong>中，即可。</p> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/sofeware.html" class="tag">sofeware</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/hao-yong-de-gong-ju-he-ruan-jian-ji-lu.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-04-05 19:41:06+08:00">
                            <script>document.write(moment('2016-04-05 19:41:06+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/emacs.html"><span class="category-tag">Emacs</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/wo-de-emacsde-pei-zhi.html">
                        <h2>我的Emacs的配置</h2>
                    </a>
                </header>
                <div class="summary"><h4>记录Emacs的相关配置和插件，以备万一。 ~/.emacs/init.el</h4>
<div class="highlight"><pre><span></span><span class="c1">;;; package --- Emacs Configure</span>
<span class="c1">;;; Commentary:</span>
<span class="c1">;;; code:</span>
<span class="p">(</span><span class="nb">require</span> <span class="ss">&#39;package</span><span class="p">)</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">&#39;package-archives</span> <span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;melpa&quot;</span> <span class="o">.</span> <span class="s">&quot;http://melpa.org/packages/&quot;</span><span class="p">))</span>

<span class="p">(</span><span class="nv">package-initialize</span><span class="p">)</span>
<span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">not</span> <span class="nv">package-archive-contents</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">package-refresh-contents</span><span class="p">))</span>

<span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nf">memq</span> <span class="nf">window-system</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">mac</span> <span class="nv">ns</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">exec-path-from-shell-initialize</span><span class="p">))</span>

<span class="c1">;; add maunal/ and top dir to load-path</span>
<span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">base</span> <span class="s">&quot;~/.emacs.d/maunal&quot;</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">&#39;load-path</span> <span class="nv">base</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">f</span> <span class="p">(</span><span class="nf">directory-files</span> <span class="nv">base</span><span class="p">))</span>
    <span class="p">(</span><span class="k">let ...</span></pre></div> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/emacs.html" class="tag">Emacs</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/wo-de-emacsde-pei-zhi.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-28 21:18:08+08:00">
                            <script>document.write(moment('2016-03-28 21:18:08+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/github.html"><span class="category-tag">github</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/shi-xian-bo-ke-de-zi-dong-bian-yi-fa-bu.html">
                        <h2>实现博客的自动编译发布</h2>
                    </a>
                </header>
                <div class="summary"><h3>使用github、coding和travis-ci实现在线编辑和自动发布！</h3>
<h4>在线编辑</h4>
<p>使用github在线创建和编辑文章。</p>
<h4>自动发布</h4>
<p>使用travis-ci自动编译和发布到github、coding的相应repo的gh-pages分支</p> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/blog.html" class="tag">blog</a></li>
                        <li><a href="https://importcjj.github.io/tag/travis-ci.html" class="tag">travis-ci</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/shi-xian-bo-ke-de-zi-dong-bian-yi-fa-bu.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-27 03:37:03+08:00">
                            <script>document.write(moment('2016-03-27 03:37:03+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/docker.html"><span class="category-tag">Docker</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/dockerfilecan-shu-xue-xi.html">
                        <h2>Dockerfile参数学习</h2>
                    </a>
                </header>
                <div class="summary"><h4>镜像和容器</h4>
<p>容器是镜像的实例。一个镜像可以对应多个容器。每次使用<code>docker run &lt;image&gt;</code>时都会重新创建该镜像的一个容器，我们可以为该命令指定--name <name>来为所产生的容器指定名字:</p>
<p><code>docker run -d --name serve ubuntu</code> 这样根据ubuntu这个镜像产生的容器就叫<em>serve</em>。</p>
<p>。当容器运行时，我们对容器的修改只会写人到容器的文件系统，而不会影响到对应镜像。所以， 前一次run形成的改动不会影响到后一次run所创建的容器。想要这些修改对image生效， 可以使用<code>docker commit &lt;container&gt;</code></p>
<div class="highlight"><pre><span></span>                <span class="err">├─</span> <span class="err">可写层</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
<span class="err">内核层</span> <span class="o">-</span> <span class="err">镜像层</span> <span class="err">─</span> <span class="err">├─</span> <span class="err">可写层</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
                <span class="err">├─</span> <span class="err">可写层</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
</pre></div>


<p><strong>内核层 - 镜像层 -可写层(container)</strong></p>
<h4>CMD和ENTRYPOINT的区别</h4>
<p>首先两者都可以让你在容器运行的时候执行一条命令，而且这两个字段在Dockerfile中只能指定一次，如果指定多次，那么则以最后一次为准。</p>
<p>再来说两者的区别: 假如我们在运行容器的命令<code>docker run &lt;image ...</code></p> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/docker.html" class="tag">Docker</a></li>
                        <li><a href="https://importcjj.github.io/tag/dockerfile.html" class="tag">Dockerfile</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/dockerfilecan-shu-xue-xi.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-27 03:37:03+08:00">
                            <script>document.write(moment('2016-03-27 03:37:03+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/git.html"><span class="category-tag">git</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/gitzhong-yi-xie-rong-yi-bei-hu-shi-de-dong-xi.html">
                        <h2>Git中一些容易被忽视的东西</h2>
                    </a>
                </header>
                <div class="summary"><h4>修改commit的message</h4>
<ol>
<li>修改最近一次commit的message  <code>git commit --amend</code> 然后输入想要修改的message</li>
<li>批量修改commit的message <code>git rebase -i HEAD~n</code> n为一个数字，表示最近n次commit, 将想要修改的commit id前的pick改成reword(r)命令, 然后修改id后的commit message,  保存退出后即可.</li>
</ol>
<h4>合并连续的多个commit为一个commit</h4>
<p>使用<code>git rebase -i HEAD~n</code> 把将被合并的commit id前的pick命令改成squash(s)</p>
<h4>忽略已被提交过的文件</h4>
<ol>
<li><code>git rm --cached &lt;filename&gt;</code> 不用担心，这一步只是删除该文件在版本库中的追踪，并不会正真删除磁盘上的物理文件</li>
<li>更新.gitignore文件, 如果之前已经更新过了，就可以直接跳过这一步了。</li>
<li>add + commit 提交</li>
</ol>
<h4>新建一个orphan(孤儿)分支</h4>
<p><code>git ...</code></p> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/git.html" class="tag">git</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/gitzhong-yi-xie-rong-yi-bei-hu-shi-de-dong-xi.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-27 03:37:03+08:00">
                            <script>document.write(moment('2016-03-27 03:37:03+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/go.html"><span class="category-tag">Go</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/golangzhong-san-chong-importfang-shi.html">
                        <h2>Golang中三种import方式</h2>
                    </a>
                </header>
                <div class="summary"><h4>1. 点方式</h4>
<p>有时候会看到如下的方式导入包    <code>import( . "fmt" )</code></p>
<p>这个点操作的含义就是这个包导入之后在你调用这个包的函数时，你可以省略前缀的包名，也就是前面你调用的<code>fmt.Println("hello world")</code>  可以省略的写成<code>Println("hello world")</code></p>
<h4>2. 别名方式</h4>
<p>别名操作顾名思义可以把包命名成另一个用起来容易记忆的名字。</p>
<p><code>import( f "fmt" )</code>  别名操作调用包函数时前缀变成了重命名的前缀，即<code>f.Println("hello world")</code></p>
<h4>3.  _方式</h4>
<p>_操作其实只是引入该包。当导入一个包时，它所有的init()函数就会被执行，但有些时候并非真的需要使用这些包，仅仅是希望它的init()函数被执行而已。这个时候就可以使用_操作引用该包了。即使用_操作引用包是无法通过包名来调用包中的导出函数，而是只是为了简单的调用其init函数()。</p>
<p>比如 <code>import (_ "github.com/mattn/go-sqlite3")</code>只是为了调用该包中的init函数来注册该数据库驱动而已，并需要该包中的其他内容。</p> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/golang.html" class="tag">golang</a></li>
                        <li><a href="https://importcjj.github.io/tag/import.html" class="tag">import</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/golangzhong-san-chong-importfang-shi.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-27 03:37:03+08:00">
                            <script>document.write(moment('2016-03-27 03:37:03+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/docker.html"><span class="category-tag">Docker</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/guan-yu-dockerde-yi-xie-za-huo.html">
                        <h2>关于Docker的一些杂货</h2>
                    </a>
                </header>
                <div class="summary"><h4>如何在外部获取容器的日志?</h4>
<p>可以使用<code>docker logs -f &lt;container&gt;</code>的方式在宿主机显示容器进程所产生的日志，就像我们使用tail那样。但是如果我们需要访问的并不是容器主进程所记录的日志呢？比如说，现在有一个很简单的web应用，我们选择让他运行在Docker容器里面，web服务器使用了gunicorn，它支持使用参数<code>--access-file=filename</code>来将该web应用的访问请求记录到指定的日志中去。当我们需要方便的获取这些访问记录或者实时查看的时候，应该怎么做？</p>
<p>当我们的web应用运行时，gunicorn所记录的日志只存在于docker系统的读写层(容器container)，而不会影响到只读层(镜像image)。如果我们想要较为方便的得到容器中的日志文件，可以使用Docker提供的的<code>volume</code>。你可以理解为将宿主系统的文件夹挂载至容器中从而达到实时共享文件夹的目的。</p>
<p>你可以在很多地方指定volume, 比如:</p>
<h5>1. Dockerfile 的<code>VOLUME</code>命令</h5>
<div class="highlight"><pre><span></span><span class="c"># Dockerfile</span>

<span class="k">RUN</span> mkdir -p /data/logs/webapp
<span class="k">VOLUME</span><span class="s"> /data/logs/webapp</span>
</pre></div>


<p>当你使用该Dockerfile去build一个镜像，并使用该镜像来运行了一个容器实例的时候，宿主系统的某个文件夹就会被挂载为该容器的<code>/data ...</code></p> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/docker.html" class="tag">Docker</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/guan-yu-dockerde-yi-xie-za-huo.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-27 03:37:03+08:00">
                            <script>document.write(moment('2016-03-27 03:37:03+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/markdown.html"><span class="category-tag">Markdown</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/markdownyu-fa-shuo-ming.html">
                        <h2>MarkDown语法说明</h2>
                    </a>
                </header>
                <div class="summary"><p>本篇博文参考<a href="http://blog.csdn.net/lanxuezaipiao/article/details/44307757">这里</a></p>
<blockquote>
<p>Markdown 是一种轻量级标记语言，它允许人们使用易读易写的纯文本格式编写文档，然后转换成格式丰富的HTML页面。
<br></p>
</blockquote>
<h4>标题语法</h4>
<p>形式一:</p>
<div class="highlight"><pre><span></span><span class="err">标题</span><span class="mi">1</span>
<span class="o">====</span><span class="p">(</span><span class="err">至少一个</span><span class="p">,</span><span class="err">同行不能有其他字符</span><span class="p">)</span>
<span class="err">标题</span><span class="mi">2</span>
<span class="c1">----</span>
</pre></div>


<p>效果:</p>
<h1>标题1</h1>
<h2>标题2</h2>
<p>形式二:</p>
<div class="highlight"><pre><span></span><span class="err">示例：</span>
<span class="o">#</span> <span class="err">标题</span><span class="mi">1</span> <span class="o">#</span><span class="p">(</span><span class="err">可以闭合，也可以不闭合，闭合的话数量也不一定要相同</span><span class="p">)</span>
<span class="o">##</span> <span class="err">标题</span><span class="mi">2</span>
<span class="o">###</span> <span class="err">标题</span><span class="mi">3</span>
<span class="o">####</span> <span class="err">标题</span><span class="mi">4</span>
<span class="o">#####</span> <span class="err">标题</span><span class="mi">5</span>
<span class="o">######</span> <span class="err">标题</span><span class="mi">6</span>
</pre></div>


<p>效果:</p>
<h1>标题1</h1>
<h2>标题2</h2>
<h3>标题3</h3>
<h4>标题4</h4>
<h5>标题5</h5>
<h6>标题6</h6>
<p><br><br></p>
<h4>段落和换行</h4>
<p><code>空格</code>：多个空格或者一个回车符(只能显示一个空格)</p>
<p><code>多空格</code>：\&nbsp;</p>
<p><code>段内换行</code>：双空格 + 回车符</p>
<p><code>另起一段 ...</code></p> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/markdown.html" class="tag">markdown</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/markdownyu-fa-shuo-ming.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-27 03:37:03+08:00">
                            <script>document.write(moment('2016-03-27 03:37:03+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/python.html"><span class="category-tag">Python</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/python-yieldxiao-ji.html">
                        <h2>Python yield小记</h2>
                    </a>
                </header>
                <div class="summary"><h4>yeild</h4>
<p><em>yield</em> 一般搭配函数来定义一个Generator(生成器)</p>
<p>一个简单的例子:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
    <span class="k">print</span> <span class="s2">&quot;Today is 7.21&quot;</span>
    <span class="k">yield</span> <span class="mi">6</span>
</pre></div>


<p><em>f()</em> 将会返回一个Generator, 而非像普通函数一样执行。想要使用生成器的话(比如 i)需要使用i.next() (与next(i)等效) 和i.send(value)。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">f</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span>
<span class="o">&lt;</span><span class="n">generator</span> <span class="nb">object</span> <span class="n">f</span> <span class="n">at</span> <span class="mh">0x1041e7dc0</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="n">Today</span> <span class="ow">is</span> <span class="mf">7.21</span>
<span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last ...</span></pre></div> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/yield.html" class="tag">yield</a></li>
                        <li><a href="https://importcjj.github.io/tag/sheng-cheng-qi.html" class="tag">生成器</a></li>
                        <li><a href="https://importcjj.github.io/tag/python.html" class="tag">Python</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/python-yieldxiao-ji.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-27 03:37:03+08:00">
                            <script>document.write(moment('2016-03-27 03:37:03+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/python.html"><span class="category-tag">Python</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/pythonzhong-yi-xie-rong-yi-bei-hu-shi-de-dong-xi.html">
                        <h2>Python中一些容易被忽视的东西</h2>
                    </a>
                </header>
                <div class="summary"><h3>旨在记录Python标准库中好像很厉害的模块或功能。</h3>
<h5>1. <a href="#particial">functools.partial(func[,<em>args][, </em>*keywords])</a></h5>
<h5>2. <a href="#globals_and_locals">globals() and locals()</a></h5>
<h4><a id="particial">functools.partial(func[,<em>args][, </em>*keywords])</a></h4>
<p>为func的参数指定默认值后返回一个新的函数。比如:</p>
<div class="highlight"><pre><span></span><span class="c1"># disable print as the statement</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">StringIO</span> <span class="kn">import</span> <span class="n">StringIO</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">StringIO</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
<span class="k">print</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="k">print</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;This will print to f)</span>
<span class="c1"># stdout ...</span></pre></div> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/python.html" class="tag">Python</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/pythonzhong-yi-xie-rong-yi-bei-hu-shi-de-dong-xi.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-27 03:37:03+08:00">
                            <script>document.write(moment('2016-03-27 03:37:03+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/python.html"><span class="category-tag">Python</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/shi-yong-pythonzhi-zuo-zi-ding-yi-zhong-duan-ming-ling.html">
                        <h2>使用Python制作自定义终端命令</h2>
                    </a>
                </header>
                <div class="summary"><h3>介绍</h3>
<p>首先，拿pip举个例子，pip是我们使用较多的python包管理工具。当我们安装pip之后，直接在终端中就可以使用pip这个命令。那你有没有想过这是如何实现的？</p>
<p>其实，pip这个命令最终调用了python所在文件夹bin目录的pip文件。为什么说最终？因为使用系统默认的python安装pip时，可能会在/usr/local/bin或者/usr/bin下创建软链接。如果使用了virtualenv，那么pip文件就在env/bin下。那么pip文件到底是什么呢？答案就是，是一个具有执行权限的python文件，只不过去掉了.py的后缀.</p>
<p>也许你会兴高采烈的去尝试一发，在bin文件下创建xxx.py，打上一句 print “hello world”, 然后去掉.py的后缀, 再使用chmod a+x xxx来赋予它执行的权限。打开终端，敲下xxx。最后你只会得到print: command not found的错误提示。为什么？因为操作系统不知道这是一个py文件。思考一下，我们平时运行py文件都需要打上python xxx.py形式的命令 ...</p> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/python.html" class="tag">Python</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/shi-yong-pythonzhi-zuo-zi-ding-yi-zhong-duan-ming-ling.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-27 03:37:03+08:00">
                            <script>document.write(moment('2016-03-27 03:37:03+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/python.html"><span class="category-tag">Python</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/supervisorcelerycelerybeatde-jian-dan-shi-yong.html">
                        <h2>supervisor+celery+celerybeat的简单使用</h2>
                    </a>
                </header>
                <div class="summary"><h2>1. 提前准备</h2>
<p>略去相关工具的安装过程，其实都挺简单的!</p>
<p>celery作为异步任务队列, 需要一个中间人来协助celery存放和消耗任务信息。我们选择rabbitmq来做消息代理人。使用celery之前, 需要使用创建一个rabbitmq的管理员账号和一个能让该账号访问的vhost.</p>
<p><strong><a href="">Rabbitmq的安装配置以及网页管理插件</a></strong></p>
<p>假设准备的rabbitmq的信息如下:</p>
<div class="highlight"><pre><span></span><span class="n">SETTINGS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;www-data&#39;</span><span class="p">,</span>
    <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="s1">&#39;www-data&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="s1">&#39;5672&#39;</span><span class="p">,</span>
    <span class="s1">&#39;vhost&#39;</span><span class="p">:</span> <span class="s1">&#39;t_celery&#39;</span>
<span class="p">}</span>
</pre></div>


<h3>示例项目结构</h3>
<div class="highlight"><pre><span></span><span class="n">test</span><span class="p">.</span><span class="n">celery</span><span class="o">/</span>
    <span class="o">|-</span> <span class="n">env</span><span class="o">/</span>
    <span class="o">|-</span> <span class="n">src</span><span class="o">/</span>
        <span class="o">|-</span> <span class="n">__init__</span><span class="p">.</span><span class="n">py</span>
        <span class="o">|-</span> <span class="n">app</span><span class="p">.</span><span class="n">py</span>
        <span class="o">|-</span> <span class="n">task</span><span class="p">.</span><span class="n">py</span>
</pre></div>


<h2>2. celery实例及任务</h2>
<h3>2.1 生成实例</h3>
<div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1"># filename: app.py</span>

<span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">Celery ...</span></pre></div> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/supervisor.html" class="tag">supervisor</a></li>
                        <li><a href="https://importcjj.github.io/tag/celery.html" class="tag">celery</a></li>
                        <li><a href="https://importcjj.github.io/tag/python.html" class="tag">Python</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/supervisorcelerycelerybeatde-jian-dan-shi-yong.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-27 03:37:03+08:00">
                            <script>document.write(moment('2016-03-27 03:37:03+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/python.html"><span class="category-tag">Python</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/zhong-duan-jin-du-tiao-de-jian-dan-yuan-li.html">
                        <h2>终端进度条的简单原理</h2>
                    </a>
                </header>
                <div class="summary"><h4>进度条</h4>
<p>每次使用pip安装一些第三方库时，总会在终端或者命令行中看到进度条，能够让用户等待时得到当前任务的进度。今天偶然在知乎看到一个帖子中提到了这个有趣的功能。</p>
<h4>实现方式</h4>
<p>一般情况下命令行和终端的输出总是由上往下一行一行输出。如果我们需要实现进度条的效果的效果的话，就需要每次输出都在同一行上，不断地用后来的输出去覆盖之前的输出，从而模拟出一种动态变化的效果。那究竟怎样实现呢？答案就是使用<strong>反杠r</strong>。</p>
<p><strong>反杠n</strong>是换行，<strong>反杠r</strong>就只是把输出光标移到行首，而不换行。根据这个思路，我们先做个倒计时来玩玩。</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">CountDown</span><span class="p">(</span><span class="n">total_sec</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># 不能换行哈</span>
        <span class="k">print</span> <span class="s1">&#39;</span><span class="si">%4d</span><span class="se">\\</span><span class="s1">r&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 防止输出被之后的输出覆盖</span>
    <span class="k">print</span>

<span class="n">CountDown</span><span class="p">(</span><span class="mi">10 ...</span></pre></div> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/python.html" class="tag">Python</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/zhong-duan-jin-du-tiao-de-jian-dan-yuan-li.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-26 17:50:50+08:00">
                            <script>document.write(moment('2016-03-26 17:50:50+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/python.html"><span class="category-tag">Python</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/pythondan-ceng-zhuang-shi-qi-xiao-ji.html">
                        <h2>Python单层装饰器小记</h2>
                    </a>
                </header>
                <div class="summary"><h4>解释器什么时候处理装饰器？</h4>
<p>答: Python解释器加载代码的时候.</p>
<p>例如, sleep.py 代码如下</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">time</span>


<span class="k">def</span> <span class="nf">timer</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;handle decorator&quot;</span><span class="p">)</span>

    <span class="nd">@functools.wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">rtn</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;cost </span><span class="si">%f</span><span class="s2"> s&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">cost</span>
        <span class="k">return</span> <span class="n">rtn</span>
    <span class="k">return</span> <span class="n">wrapper</span>


<span class="nd">@timer</span>
<span class="k">def</span> <span class="nf">sleep</span><span class="p">(</span><span class="n">seconds</span><span class="p">):</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep ...</span></pre></div> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/zhuang-shi-qi.html" class="tag">装饰器</a></li>
                        <li><a href="https://importcjj.github.io/tag/python.html" class="tag">Python</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/pythondan-ceng-zhuang-shi-qi-xiao-ji.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-26 17:50:50+08:00">
                            <script>document.write(moment('2016-03-26 17:50:50+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/python.html"><span class="category-tag">Python</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/pythonde-metaclassxiao-ji.html">
                        <h2>Python的metaclass小记</h2>
                    </a>
                </header>
                <div class="summary"><p>使用metaclass的时候可以使用<strong>metaclass</strong>的<code>__new__</code>和<code>__init__</code>去改变所定义的类的相关属性，因为这两个方法是在类定义的时候被调用，他们所需的参数也与使用<code>type(name, bases, dict)</code>动态声明类相同。而使用<strong>metaclass</strong>的<code>__call__</code>可以影响我们所声明的类产生实例的过程，因为当我们使用class_name()去产生实例的时候，相当于call了这个class，而这个class又是metaclass的实例，所以其实调用了metaclass的__call__</p>
<p>注意: 通过<code>super</code>来调用父类的<code>__new__</code>时，第一个参数需要是该class，这点是不同于调用<code>__init__</code>等其他父类方法的。因为<code>__new__</code>是个静态方法。还有一个小问题就是当父类是object的时候，也就是调用<code>object.__new__()</code>只传一个cls参数就可以了，至于为什么，请戳<a href="https://mail.python.org/pipermail/python-dev/2008-February/076854.html">here</a>
和<a href="http://bugs.python.org/issue1683368">here</a>。 如果你重写了<code>__new__</code>而没有重写 ...</p> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/metaclass.html" class="tag">metaclass</a></li>
                        <li><a href="https://importcjj.github.io/tag/python.html" class="tag">Python</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/pythonde-metaclassxiao-ji.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
        <li>
            <article>
                <footer>
                        <p>
                        <time datetime="2016-03-26 17:50:50+08:00">
                            <script>document.write(moment('2016-03-26 17:50:50+08:00').format('LL'));</script>
                        </time>
                                in <a href="https://importcjj.github.io/category/centos.html"><span class="category-tag">CentOS</span></a>
                    </p>
                </footer>
                <header>
                    <a href="https://importcjj.github.io/sheng-ji-centosde-pythonban-ben.html">
                        <h2>升级CentOS的Python版本</h2>
                    </a>
                </header>
                <div class="summary"><p>服务器(centos)上默认的python版本是python2.6，但是平时使用的是2.7，故手动升级一下吧。</p>
<p>下载最新版本<a href="https://www.python.org/ftp/python/2.7.10/Python-2.7.10.tgz">Python-2.7.10</a></p>
<div class="highlight"><pre><span></span>wget https://www.python.org/ftp/python/2.7.10/Python-2.7.10.tgz

tar -zxvf Python-2.7.10.tgz
</pre></div>


<p>提前安装依赖</p>
<div class="highlight"><pre><span></span>yum install zlib
yum install zlib-devel
yum install openssl -y
yum install openssl-devel -y
</pre></div>


<p>配置编译安装替换</p>
<div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">Python</span><span class="o">-</span><span class="mi">2 ...</span></pre></div> </div>
                <div class="tags">
                    <ul class="tags">
                        <li><a href="https://importcjj.github.io/tag/centos.html" class="tag">CentOS</a></li>
                        <li><a href="https://importcjj.github.io/tag/python.html" class="tag">Python</a></li>
                        <li><a href="https://importcjj.github.io/tag/yun-wei.html" class="tag">运维</a></li>
                    </ul>
                </div>
                <a href="https://importcjj.github.io/sheng-ji-centosde-pythonban-ben.html">
                    <p class="readmore">Read more...</p>
                </a>
            </article>
        </li>
    </ol>
</div>
                <footer>
                    <div class="icons">
                    </div>
                    <p>© <script>document.write(moment().format('YYYY'));</script> importcjj</p>
                </footer>
        </div>
</body>
</html>